{% extends 'base.html' %}

{% block content %}
<div class="container">
    {% for patient in patients %}
    {% url 'patient-story' patient.id as patient_story_url %}
    <div class="patient-profile">
        <a class="patient-photo" href="{{patient_story_url}}">
            {% if patient.thumbnail %}
            <img src="{{patient.thumbnail.url}}" />
            {% else %}
            <span class="patient-photo-placeholder"></span>
            {% endif %}    
        </a>
        <h2><a href="{{patient_story_url}}">{{patient.name}}</a></h2>
        <ul class="patient-attributes">
            {% for attribute in patient.attributes %}
            <li>
                {% if attribute.description %}
                <span data-toggle="popover" data-content="{{attribute.description}}">{{attribute.name}}</span>
                {% else %}
                <span>{{attribute.name}}</span>
                {% endif %}
                {{attribute.value}}
            </li>
            {% endfor %}
        </ul>
        {% if show_highlights and patient.story_highlights %}
        <div class="collapsible-content">
            <h3 class="title">Story Highlights</h3>
            <div class="content">
                {% for highlight in patient.story_highlights %}
                {% if highlight.title %}
                <strong>{{highlight.title}}</strong>
                {% endif %}
                <p>{{highlight.content}}</p>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        {% if show_tags and patient.published_tags %}
        <ul class="tags">
        {% for tag in patient.published_tags %}
            {% if tag.warning %}
            <li class="warning">{{tag.name}}</li>
            {% else %}
            <li>{{tag.name}}</li>
            {% endif %}
        {% endfor %}
        </ul>
        {% endif %}
        <a href="{{patient_story_url}}">View {{patient.name}}'s story</a>
    </div>
    {% endfor %}
</div>
{% endblock %}
